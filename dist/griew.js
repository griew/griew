"use strict";var Griew=function(e){var t=function(){var e={},t="fa",n=function(t,n){for(var a=t.split("."),r=e,i=0;i<a.length&&a[i]in r;i++)r=r[a[i]];r[a[i]]=n},a=function(e){t=e||t},r=function(){return t},i=function(e){return t===e},o=function(t,n){var a=t.split(".");if(void 0==e[n])return!1;for(var r=e[n],i=0;i<a.length;i++){if(!(a[i]in r))return!1;r=r[a[i]]}return r},s=function(e,t){var n=o(e,t);return n||e},u=function(e,n){return n=n||t,e=e||"",s(e,n)};this.setLang=n,this.setLocale=a,this.getLocale=r,this.isLocale=i,this.trans=u,n("en",{filter:{string:{operators:{IsEqualTo:"Is Equal To",IsNotEqualTo:"Is Not Equal To",StartWith:"Start With",DoesNotContains:"Does Not Contains",EndsWith:"Ends With",Contains:"Contains"},operand:"Expression",accept:"Accept",clear:"Clear"},number:{operators:{IsEqualTo:"Is Equal To",IsNotEqualTo:"Is Not Equal To",Between:"Between",IsGreaterThanOrEqualTo:"Is Greater Than Or Equal To",IsGreaterThan:"Is Greater Than",IsLessThanOrEqualTo:"Is Less Than Or Equal To",IsLessThan:"Is Less Than"},operand:"Number",operand1:"From",operand2:"To",accept:"Accept",clear:"Clear"},datetime:{operators:{IsEqualTo:"Is Equal To",IsNotEqualTo:"Is Not Equal To",Between:"Between",IsAfterThanOrEqualTo:"Is After Than Or Equal To",IsAfterThan:"Is After Than",IsBeforeThanOrEqualTo:"Is Before Than Or Equal To",IsBeforeThan:"Is Before Than"},operand:{year:"Year",month:"Month",day:"Day",hour:"Hour",minute:"Minute"},accept:"Accept",clear:"Clear"},enum:{accept:"Accept",clear:"Clear"}},order:{ascending:"Ascending",descending:"Descending","clear sort":"Clear Sort"}}),n("fa",{filter:{string:{operators:{IsEqualTo:"برابر باشد با",IsNotEqualTo:"برابر نباشد با",StartWith:"شروع شود با",DoesNotContains:"شامل نشود",EndsWith:"خاتمه یابد با",Contains:"شامل شود"},operand:"عبارت",accept:"اعمال فیلتر",clear:"حذف فیلتر"},number:{operators:{IsEqualTo:"مساوی باشد با",IsNotEqualTo:"مساوی نباشد با",Between:"بین",IsGreaterThanOrEqualTo:"بزرگ‌تر یا مساوی ",IsGreaterThan:"بزرگ‌تر از",IsLessThanOrEqualTo:"کوچک‌تر یا مساوی",IsLessThan:"کوچک‌تر از"},operand:"عدد",operand1:"از",operand2:"تا",accept:"اعمال فیلتر",clear:"حذف فیلتر"},datetime:{operators:{IsEqualTo:"برابر باشد با",IsNotEqualTo:"برابر نباشد با",Between:"بین",IsAfterThanOrEqualTo:"پس از یا برابر باشد با",IsAfterThan:"پس از",IsBeforeThanOrEqualTo:"قبل از یا برابر باشد با",IsBeforeThan:"قبل از"},operand:{year:"سال",month:"ماه",day:"روز",hour:"ساعت",minute:"دقیقه"},accept:"اعمال فیلتر",clear:"حذف فیلتر"},enum:{accept:"اعمال فیلتر",clear:"حذف فیلتر"}},order:{ascending:"ترتیب صعودی",descending:"ترتیب نزولی","clear sort":"حذف ترتیب"}})},n=function(){var e=[],t={},n=[],a=[],r={},i=function(t){var n=o(t.name);n>=0?e[n]=t:e.push(t)},o=function(t){for(var n in e)if(e[n].name==t)return n;return-1},s=function(){return e},u=function(e){t=e},l=function(){return t},d=function(e){var t=c(e.name);t>=0?n[t]=e:n.push(e)},c=function(e){for(var t in n)if(n[t].name==e)return t;return-1},v=function(){return n},b=function(e){var t=w(e.name);t>=0?a[t]=e:a.push(e)},w=function(e){for(var t in a)if(a[t].name==e)return t;return-1},C=function(){return a},y=function(e){r=e},$=function(){return[s(),v(),C(),l(),r]},P=function(){return{columns:s(),filters:v(),orders:C(),pagination:l(),extra:r}},T=function(){return JSON.stringify(P())},x=function(){for(var e=p.columns().toArray(),t=0;t<e.length;t++)i(e[t]);u(m.getPage());for(var n=f.toArray(),t=0;t<n.length;t++)d(n[t]);for(var a=g.toArray(),t=0;t<a.length;t++)b(a[t]);return h.exists("extra")&&y(h.get("extra")),{toArray:$,toObject:P,toJson:T}};this.collect=x},a=function(){var e=[],t=[],n={},a=[],r=[],i={},o=function(t){e=t},s=function(){return e},u=function(e){var n=d(e.name);n>=0?t[n]=e:t.push(e)},l=function(e){var n=d(e);return n>=0?t[n]:null},d=function(e){for(var n in t)if(t[n].name==e)return n;return-1},c=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)u(e[t])},p=function(){return t},f=function(e){n=e},g=function(){return n},m=function(e){var t=v(e.name);t>=0?a[t]=e:a.push(e)},h=function(e){var t=v(e);return t>=0?a[t]:null},v=function(e){for(var t in a)if(a[t].name==e)return t;return-1},b=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)m(e[t])},w=function(){return a},C=function(e){var t=$(e.name);t>=0?r[t]=e:r.push(e)},y=function(e){var t=$(e);return t>=0?r[t]:null},$=function(e){for(var t in r)if(r[t].name==e)return t;return-1},P=function(e){if(Array.isArray(e))for(var t=0;t<e.length;t++)C(e[t])},T=function(){return r},x=function(e){i=e},I=function(){return i};this.setData=o,this.getData=s,this.addColumn=u,this.getColumn=l,this.addColumns=c,this.getColumns=p,this.setPagination=f,this.getPagination=g,this.addFilter=m,this.getFilter=h,this.addFilters=b,this.getFilters=w,this.addOrder=C,this.getOrder=y,this.addOrders=P,this.getOrders=T,this.setExtra=x,this.getExtra=I},r=function(){var e={},t="",n=function(e){t=e},r=function(){return t},i=function(t){return void 0!==e[t]},o=function(t,n){e[t]=n},s=function(t){return i(t)?new e[t](h):null},u=function(){return s(t)},l=function(e,t,n){var r=u();return"function"==typeof t?n=t:t&&(r=s(t)),null===r?r:r.run(e,new a,n)};this.set=o,this.get=s,this.setDefault=n,this.getDefault=r,this.run=l,o("json",function(e){var t,n,a,r=function(e,t){return e},i=function(e,t){return e},o=function(e,t){return t.total=e.length,t.perPage=t.perPage||15,t.currentPage=t.currentPage||1,t.from=(t.currentPage-1)*t.perPage+1,t.count=e.length-t.from>=t.perPage?t.perPage:e.length-t.from+1,t.lastPage=Math.ceil(t.total/t.perPage),e.slice(t.from-1,t.from+t.count-1)},s=function(e,t){return t},u=function(e,t,u){var l,d=e.toObject();l=r(n,d.filters),l=i(l,d.orders),l=o(l,d.pagination),t.setData(l),t.addFilters(d.filters),t.addOrders(d.orders),t.setPagination(d.pagination),t.setExtra(d.extra),a?t.addColumns(s(0,d.columns)):t.addColumns(d.columns),u(t)};this.run=u,function(){if(a=!1,e.exists("autoGenerateColumns")&&(a=e.get("autoGenerateColumns")),e.exists("dataSource")&&(t=e.get("dataSource")),"string"==typeof t&&(n=JSON.parse(t)),!Array.isArray(n))throw"Data most be array"}()}),o("ajax",function(e){var t,n,a,r=function(e,t){return t},i=function(e,i,o){var s=e.toJson();$.post(t,{griew:s,_token:a},function(e){e=JSON.parse(e),i.setData(e.data),i.addFilters(e.filters),i.addOrders(e.orders),i.setPagination(e.pagination),i.setExtra(e.extra),n?i.addColumns(r(0,e.columns)):i.addColumns(e.columns),o(i)})};this.run=i,function(){n=!1,e.exists("autoGenerateColumns")&&(n=e.get("autoGenerateColumns")),e.exists("dataSource")&&(t=e.get("dataSource")),e.exists("token")&&(a=e.get("token"))}()})},i=function(){var e=function(){var e="tbody",t="<tr>{columns}</tr>",n=function(e,t){return t},a=function(e){return e},r=function(e,r,i,o){var s="",u="",l=0,d="";for(t=n(r,t,i);l<e.length;l++)d=e[l],s+=o(d,r,i,l+1);return u=w("columns",s,t),u=$(u).addClass("griew-data-row")[0].outerHTML,u=a(u)};Object.defineProperty(this,"beforeRender",{set:function(e){"function"==typeof e&&(n=e)}}),Object.defineProperty(this,"afterRender",{set:function(e){"function"==typeof e&&(a=e)}}),Object.defineProperty(this,"container",{set:function(t){e=t},get:function(){return e}}),Object.defineProperty(this,"template",{set:function(e){t=e},get:function(){return t}}),this.render=function(e,t,n,a){return r(e,t,n,a)}},t=function(){var e=function(e){},t=function(e){},n={},a=function(e,t){return(t?".":"")+"griew-column-"+e},r=function(e,t,a,r,i,o,s,u,l,d,c,p){n[e]={name:e,caption:t,schema:a,type:r,order:i||1,visibility:void 0===o||o,template:l||"<td>{"+e+"}</td>",sortable:s,filterable:u,options:d,beforeRender:c||function(e,t,n,a,r){return n},afterRender:p||function(e,t,n,a){return t}}},i=function(e){return n[e]},o=function(e){delete n[e]},s=function(t){i(t).visibility=!0,p.render(),e(t)},u=function(e){i(e).visibility=!1,p.render(),t(e)},l=function(e){return!0===i(e).visibility},d=function(e){var t=!e,a=[],r=[];for(var i in n)n[i].visibility&&a.push(n[i]);t&&a.sort(function(e,t){return e.order-t.order});for(var i in a)a[i].visibility&&r.push(a[i].name);return r},c=function(){var e=[];for(var t in n)e.push(n[t]);return e},f=function(e,t,r,i){var o="",s=n[e],u={};u.value=t[e];var l=s.beforeRender(e,u,s.template,r,i);return t[e]=u.value,o=w(t,l),o=$(o).addClass("griew-data-column").addClass(a(e))[0].outerHTML,o=s.afterRender(e,o,r,i)};Object.defineProperty(this,"onshow",{set:function(t){"function"==typeof t&&(e=t)}}),Object.defineProperty(this,"onhide",{set:function(e){"function"==typeof e&&(t=e)}}),this.add=function(e){return"object"==typeof e&&(void 0!=e.name&&""!=e.name&&(e.caption=e.caption||e.name,e.schema=e.schema||null,e.type=e.type||"string",e.order=e.order||1,e.visibility=void 0===e.visibility||e.visibility,e.template=e.template||"<td>{"+e.name+"}</td>",e.sortable=void 0===e.sortable||e.sortable,e.filterable=void 0===e.filterable||e.filterable,e.options=e.options||null,e.beforeRender=e.beforeRender||function(e,t,n,a,r){return n},e.afterRender=e.afterRender||function(e,t,n,a){return t},void r(e.name,e.caption,e.schema,e.type,e.order,e.visibility,e.sortable,e.filterable,e.template,e.options,e.beforeRender,e.afterRender)))},this.get=function(e){return i(e)},this.remove=function(e){o(e)},this.show=function(e){s(e)},this.hide=function(e){u(e)},this.isVisible=function(e){return l(e)},this.visibles=function(){return d()},this.toArray=function(){return c()},this.render=function(e,t,n,a){return f(e,t,n,a)}},n=function(){var e="thead",t="<tr>{cells}</tr>",n="<th>{cell-name}</th>",a=function(e,t){return(t?".":"")+"griew-column-"+e},r=function(e){return".griew-header-cell"+a(e,!0)},i=function(e){for(var r="",i="",o="",u=0,l="";u<e.length;u++)l=e[u],i=w("cell-name",s.get(l).caption,n),i=$(i).addClass("griew-header-cell").addClass(a(l))[0].outerHTML,r+=i;return o=w("cells",r,t),o=$(o).addClass("griew-header-row")[0].outerHTML};Object.defineProperty(this,"container",{set:function(t){e=t},get:function(){return e}}),Object.defineProperty(this,"rowTemplate",{set:function(e){t=e},get:function(){return t}}),Object.defineProperty(this,"cellTemplate",{set:function(e){n=e},get:function(){return n}}),this.render=function(e){return i(e)},this.getCellSelector=function(e){return r(e)}},a=function(){var e=function(e,t){},t=function(e,t){},n=function(e,t){return(t?".":"")+"griew-filter-"+e},a=function(e,t,a){var r=$("<div>").addClass("griew-filter-box").addClass(n(e)).append("function"==typeof a?a():a);$(t).append(r)},r=function(e,t){if(void 0===t)return void $(n(e,!0)).remove();$(t+">"+n(e,!0)).remove()},i=function(t,a){void 0===a?$(n(t,!0)).addClass("active"):$(a+">"+n(t,!0)).addClass("active"),e(t,a),y(t,a,"filter","show")},o=function(e,a){void 0===a?$(n(e,!0)).removeClass("active"):$(a+">"+n(e,!0)).removeClass("active"),t(e,a),y(e,a,"filter","hide")},u=function(a,r){void 0===r?$(n(a,!0)).toggleClass("active"):$(r+">"+n(a,!0)).toggleClass("active"),d(a,r)?e(a,r):t(a,r)},d=function(e,t){return void 0===t?$(n(e,!0)).hasClass("active"):$(t+">"+n(e,!0)).hasClass("active")};Object.defineProperty(this,"onshow",{set:function(t){e=t}}),Object.defineProperty(this,"onhide",{set:function(e){t=e}}),this.add=function(e,t,n){a(e,t,n)},this.remove=function(e,t){r(e,t)},this.show=function(e,t){i(e,t)},this.hide=function(e,t){o(e,t)},this.toggle=function(e,t){u(e,t)},this.isVisible=function(e,t){return d(e,t)},this.addString=function(e,t,n){var r=$("<div>").addClass("griew-filter-string-box"),s=$("<select>").addClass("griew-filter-string-operator"),u=$('<input type="text">').addClass("griew-filter-string-operand"),l=$('<button type="button">').addClass("griew-filter-string-btn-accept"),d=$('<button type="button">').addClass("griew-filter-string-btn-clear"),c=["Contains","DoesNotContains","IsEqualTo","IsNotEqualTo","StartWith","EndsWith"];for(var p in c)s.append($("<option>").text(P("filter.string.operators."+c[p])).val(c[p]));u.attr("placeholder",P("filter.string.operand")),l.text(P("filter.string.accept")).click(function(){f.add(e,"string",s.val(),u.val()),x(),o(e,t)}),d.text(P("filter.string.clear")).click(function(){f.remove(e),x(),o(e,t)}),r.append(s).append(u).append(l).append(d),a(e,t,r),n&&i(e,t),f.onCreate=function(n){n.name==e&&(u.val(n.operand1),s.val(n.operator).change(),$(t).children(".griew-filter-button").addClass("active"))},f.onUpdate=function(n){n.name==e&&(u.val(n.operand1),s.val(n.operator).change(),$(t).children(".griew-filter-button").addClass("active"))},f.onRemove=function(n){n.name==e&&(u.val(""),s.val("Contains").change(),$(t).children(".griew-filter-button").removeClass("active"))}},this.addNumber=function(e,t,n){var r=$("<div>").addClass("griew-filter-number-box"),s=$('<select id="operator">').addClass("griew-filter-number-operator"),u=$('<input type="number" id="operand1">').addClass("griew-filter-number-operand"),l=$('<input type="number" id="operand2">').addClass("griew-filter-number-operand"),d=$('<button type="button">').addClass("griew-filter-number-btn-accept"),c=$('<button type="button">').addClass("griew-filter-number-btn-clear"),p=["IsEqualTo","IsNotEqualTo","Between","IsGreaterThanOrEqualTo","IsGreaterThan","IsLessThanOrEqualTo","IsLessThan"];for(var g in p)s.append($("<option>").text(P("filter.number.operators."+p[g])).val(p[g]));s.change(function(){"Between"===$(this).val()?(l.removeClass("hide"),u.attr("placeholder",P("filter.number.operand1"))):(l.addClass("hide"),u.attr("placeholder",P("filter.number.operand")))}),u.attr("placeholder",P("filter.number.operand1")),l.attr("placeholder",P("filter.number.operand2")),d.text(P("filter.number.accept")).click(function(){"Between"===s.val()?f.add(e,"number",s.val(),Number(u.val()),Number(l.val())):f.add(e,"number",s.val(),Number(u.val())),x(),o(e,t)}),c.text(P("filter.number.clear")).click(function(){f.remove(e),x(),o(e,t)}),r.append(s).append(u).append(l).append(d).append(c),a(e,t,r),s.change(),n&&i(e,t),f.onCreate=function(n){n.name==e&&(u.val(n.operand1),l.val(n.operand2),s.val(n.operator).change(),$(t).children(".griew-filter-button").addClass("active"))},f.onUpdate=function(n){n.name==e&&(u.val(n.operand1),l.val(n.operand2),s.val(n.operator).change(),$(t).children(".griew-filter-button").addClass("active"))},f.onRemove=function(n){n.name==e&&(u.val(""),l.val(""),s.val("IsEqualTo").change(),$(t).children(".griew-filter-button").removeClass("active"))}},this.addDateTime=function(e,t,n,r){n=n||{};var s=$("<div>").addClass("griew-filter-datetime-box"),u=$('<select id="operator">').addClass("griew-filter-datetime-operator"),l=$('<div id="operand1">').addClass("griew-filter-datetime-operand"),d=$('<input type="number">').addClass("griew-filter-datetime-operand-year"),c=$('<input type="number">').addClass("griew-filter-datetime-operand-month"),p=$('<input type="number">').addClass("griew-filter-datetime-operand-day"),g=$('<input type="number">').addClass("griew-filter-datetime-operand-hour"),m=$('<input type="number">').addClass("griew-filter-datetime-operand-minute"),h=$("<div>").addClass("griew-filter-datetime-date-wrapper"),v=$("<div>").addClass("griew-filter-datetime-time-wrapper"),b=$('<div id="operand2">').addClass("griew-filter-datetime-operand"),w=$('<input type="number">').addClass("griew-filter-datetime-operand-year"),C=$('<input type="number">').addClass("griew-filter-datetime-operand-month"),y=$('<input type="number">').addClass("griew-filter-datetime-operand-day"),T=$('<input type="number">').addClass("griew-filter-datetime-operand-hour"),I=$('<input type="number">').addClass("griew-filter-datetime-operand-minute"),k=$("<div>").addClass("griew-filter-datetime-date-wrapper"),E=$("<div>").addClass("griew-filter-datetime-time-wrapper"),O='<span class="griew-filter-datetime-date-separator"></span>',N='<span class="griew-filter-datetime-time-separator"></span>',q=$('<button type="button">').addClass("griew-filter-datetime-btn-accept"),A=$('<button type="button">').addClass("griew-filter-datetime-btn-clear"),j=["IsEqualTo","IsNotEqualTo","Between","IsAfterThanOrEqualTo","IsAfterThan","IsBeforeThanOrEqualTo","IsBeforeThan"];for(var B in j)u.append($("<option>").text(P("filter.datetime.operators."+j[B])).val(j[B]));u.change(function(){"Between"===$(this).val()?b.removeClass("hide"):b.addClass("hide")}),d.attr({placeholder:P("filter.datetime.operand.year"),min:n.year&&n.year?n.year.min:1e3,max:n.year&&n.year?n.year.max:""}).val(n.default&&n.default.year?n.default.year:""),c.attr({placeholder:P("filter.datetime.operand.month"),min:1,max:12}).val(n.default&&n.default.month?n.default.month:""),p.attr({placeholder:P("filter.datetime.operand.day"),min:1,max:31}).val(n.default&&n.default.day?n.default.day:""),g.attr({placeholder:P("filter.datetime.operand.hour"),min:0,max:23}).val(n.default&&n.default.hour?n.default.hour:""),m.attr({placeholder:P("filter.datetime.operand.minute"),min:0,max:59}).val(n.default&&n.default.minute?n.default.minute:""),w.attr({placeholder:P("filter.datetime.operand.year"),min:n.year&&n.year.min?n.year.min:1e3,max:n.year&&n.year.max?n.year.max:""}).val(n.default&&n.default.year?n.default.year:""),C.attr({placeholder:P("filter.datetime.operand.month"),min:1,max:12}).val(n.default&&n.default.month?n.default.month:""),y.attr({placeholder:P("filter.datetime.operand.day"),min:1,max:31}).val(n.default&&n.default.day?n.default.day:""),T.attr({placeholder:P("filter.datetime.operand.hour"),min:0,max:23}).val(n.default&&n.default.hour?n.default.hour:""),I.attr({placeholder:P("filter.datetime.operand.minute"),min:0,max:59}).val(n.default&&n.default.minute?n.default.minute:""),q.text(P("filter.datetime.accept")).click(function(){var n={year:Number(d.val()),month:Number(c.val()),day:Number(p.val()),hour:Number(g.val()),minute:Number(m.val())},a={year:Number(w.val()),month:Number(C.val()),day:Number(y.val()),hour:Number(T.val()),minute:Number(I.val())};"Between"===u.val()?f.add(e,"datetime",u.val(),n,a):f.add(e,"datetime",u.val(),n),x(),o(e,t)}),A.text(P("filter.datetime.clear")).click(function(){f.remove(e),x(),o(e,t)}),n.type=n.type||"datetime",(n.type&&"date"===n.type||"datetime"===n.type)&&(h.append(d).append(O).append(c).append(O).append(p),l.append(h),k.append(w).append(O).append(C).append(O).append(y),b.append(k)),(n.type&&"time"===n.type||"datetime"===n.type)&&(v.append(g).append(N).append(m),l.append(v),E.append(T).append(N).append(I),b.append(E)),s.append(u).append(l).append(b).append(q).append(A),a(e,t,s),u.change(),r&&i(e,t),f.onCreate=function(n){n.name==e&&(n.operand1&&(d.val(n.operand1.year),c.val(n.operand1.month),p.val(n.operand1.day),g.val(n.operand1.hour),m.val(n.operand1.minute)),n.operand2&&(w.val(n.operand2.year),C.val(n.operand2.month),y.val(n.operand2.day),T.val(n.operand2.hour),I.val(n.operand2.minute)),u.val(n.operator).change(),$(t).children(".griew-filter-button").addClass("active"))},f.onUpdate=function(n){n.name==e&&(n.operand1&&(d.val(n.operand1.year),c.val(n.operand1.month),p.val(n.operand1.day),g.val(n.operand1.hour),m.val(n.operand1.minute)),n.operand2&&(w.val(n.operand2.year),C.val(n.operand2.month),y.val(n.operand2.day),T.val(n.operand2.hour),I.val(n.operand2.minute)),u.val(n.operator).change(),$(t).children(".griew-filter-button").addClass("active"))},f.onRemove=function(n){n.name==e&&(d.val(""),c.val(""),p.val(""),g.val(""),m.val(""),w.val(""),C.val(""),y.val(""),T.val(""),I.val(""),u.val("IsEqualTo").change(),$(t).children(".griew-filter-button").removeClass("active"))}},this.addEnum=function(e,t,n,r){n=n||{};var s=$("<div>").addClass("griew-filter-enum-box"),u=$("<div>").addClass("griew-filter-enum-operand"),l=$('<button type="button">').addClass("griew-filter-enum-btn-accept"),d=$('<button type="button">').addClass("griew-filter-enum-btn-clear");n.items=n.items||{};var c=n.type&&"single"==n.type?"radio":"checkbox";for(var p in n.items)u.append($("<label>").addClass("griew-filter-enum-item-control").append($("<input>").addClass("griew-filter-enum-item-input").val(p).attr({name:"filter_"+e,type:c})).append($("<span>").addClass("griew-filter-enum-item-caption").html(n.items[p])));l.text(P("filter.enum.accept")).click(function(){var n=[];u.find(".griew-filter-enum-item-input:checked").each(function(e,t){n.push(t.value)}),f.add(e,"enum","In",n),x(),o(e,t)}),d.text(P("filter.enum.clear")).click(function(){f.remove(e),x(),o(e,t)}),s.append(u).append(l).append(d),a(e,t,s),r&&i(e,t),f.onCreate=function(n){if(n.name==e){u.find(".griew-filter-enum-item-input").removeAttr("checked").prop("checked",!1);for(var a=0;a<n.operand1.length;a++)u.find(".griew-filter-enum-item-input[value="+n.operand1[a]+"]").attr("checked","checked").prop("checked",!0);$(t).children(".griew-filter-button").addClass("active")}},f.onUpdate=function(n){if(n.name==e){u.find(".griew-filter-enum-item-input").removeAttr("checked").prop("checked",!1);for(var a=0;a<n.operand1.length;a++)u.find(".griew-filter-enum-item-input[value="+n.operand1[a]+"]").attr("checked","checked").prop("checked",!0);$(t).children(".griew-filter-button").addClass("active")}},f.onRemove=function(n){n.name==e&&(u.find(".griew-filter-enum-item-input").removeAttr("checked").prop("checked",!1),$(t).children(".griew-filter-button").removeClass("active"))}},this.autoGenerate=function(e,t){var n=null,a="";for(var r in e)if(n=s.get(e[r]),a=t(n.name),n.filterable){var u=$("<button>");switch(u.addClass("griew-filter-button"),u.data("FilterBoxName",n.name),u.data("FilterBoxContainer",a),u.click(function(){var e=$(this).data("FilterBoxName"),t=$(this).data("FilterBoxContainer");d(e,t)?o(e,t):i(e,t)}),$(a).append(u),n.type){case"string":l.addString(n.name,a,!1);break;case"number":l.addNumber(n.name,a,!1);break;case"datetime":var c=n.options&&n.options.filter?n.options.filter:void 0;l.addDateTime(n.name,a,c,!1);break;case"enum":var c=n.options&&n.options.filter?n.options.filter:void 0;l.addEnum(n.name,a,c,!1);break;case"boolean":var c=n.options&&n.options.filter?n.options.filter:void 0;l.addBoolean(n.name,a,c,!1)}T(n.name,a,"filter",function(e,t,n,a){"show"!=a||"order"!=n&&"filter"!=n||o(e,t)})}}},r=function(){var e=function(e,t){},t=function(e,t){},n=function(e,t){return(t?".":"")+"griew-order-"+e},a=function(e,t,a){var r=$("<div>").addClass("griew-order-box").addClass(n(e)).append("function"==typeof a?a():a);$(t).append(r)},r=function(e,t){if(void 0===t)return void $(n(e,!0)).remove();$(t+">"+n(e,!0)).remove()},i=function(t,a){void 0===a?$(n(t,!0)).addClass("active"):$(a+">"+n(t,!0)).addClass("active"),e(t,a),y(t,a,"order","show")},o=function(e,a){void 0===a?$(n(e,!0)).removeClass("active"):$(a+">"+n(e,!0)).removeClass("active"),t(e,a),y(e,a,"order","hide")},u=function(a,r){void 0===r?$(n(a,!0)).toggleClass("active"):$(r+">"+n(a,!0)).toggleClass("active"),l(a,r)?e(a,r):t(a,r)},l=function(e,t){return void 0===t?$(n(e,!0)).hasClass("active"):$(t+">"+n(e,!0)).hasClass("active")};Object.defineProperty(this,"onshow",{set:function(t){e=t}}),Object.defineProperty(this,"onhide",{set:function(e){t=e}}),this.add=function(e,t,n){a(e,t,n)},this.remove=function(e,t){r(e,t)},this.show=function(e,t){i(e,t)},this.hide=function(e,t){o(e,t)},this.toggle=function(e,t){u(e,t)},this.isVisible=function(e,t){return l(e,t)},this.addDefault=function(e,t,n){var r=$("<ul>").addClass("griew-order-default-box"),s=$("<li>").addClass("griew-order-default-btn-sort").addClass("griew-order-default-asc-sort"),u=$("<li>").addClass("griew-order-default-btn-sort").addClass("griew-order-default-desc-sort"),l=$("<li>").addClass("griew-order-default-btn-sort").addClass("griew-order-default-clear-sort");s.append($("<a>").text(P("order.ascending"))),u.append($("<a>").text(P("order.descending"))),l.append($("<a>").text(P("order.clear sort"))),s.click(function(){g.addAscending(e),x(),o(e,t)}),u.click(function(){g.addDescending(e),x(),o(e,t)}),l.click(function(){g.remove(e),x(),o(e,t)}),r.append(s).append(u).append(l),a(e,t,r),n&&i(e,t),g.onCreate=function(n){n.name==e&&("ASC"==n.type?(s.addClass("active"),u.removeClass("active"),$(t).children(".griew-order-button").removeClass("griew-order-desc").addClass("griew-order-asc")):"DESC"==n.type&&(u.addClass("active"),s.removeClass("active"),$(t).children(".griew-order-button").removeClass("griew-order-asc").addClass("griew-order-desc")))},g.onUpdate=function(n){n.name==e&&("ASC"==n.type?(s.addClass("active"),u.removeClass("active"),$(t).children(".griew-order-button").removeClass("griew-order-desc").addClass("griew-order-asc")):"DESC"==n.type&&(u.addClass("active"),s.removeClass("active"),$(t).children(".griew-order-button").removeClass("griew-order-asc").addClass("griew-order-desc")))},g.onRemove=function(n){n.name==e&&(u.removeClass("active"),s.removeClass("active"),$(t).children(".griew-order-button").removeClass("griew-order-asc").removeClass("griew-order-desc"))}},this.autoGenerate=function(e,t){var n=null,a="";for(var r in e)if(n=s.get(e[r]),a=t(n.name),n.sortable){var u=$("<button>");u.addClass("griew-order-button"),u.data("OrderBoxName",n.name),u.data("OrderBoxContainer",a),u.click(function(){var e=$(this).data("OrderBoxName"),t=$(this).data("OrderBoxContainer");l(e,t)?o(e,t):i(e,t)}),$(a).append(u),d.addDefault(n.name,a,!1),T(n.name,a,"order",function(e,t,n,a){"show"!=a||"order"!=n&&"filter"!=n||o(e,t)})}}},i=function(){var e,t,n,a,r,i,o,s,u,l,d,c=function(c){c=c||{},e=c.container||".pagination",t=c.buttonGroupTemplate||'<ul class="pagination griew-pagination">{pagination-items}</ul>',n=c.numberButtonTemplate||'<li class="page-item griew-pagination-item"><a href="#" class="page-link griew-pagination-link" data-page="{pagination-page}" data-action="{pagination-action}">{pagination-number}</a></li>',a=c.nextButtonTemplate||'<li class="page-item griew-pagination-item"><a href="#" class="page-link griew-pagination-link" data-page="{pagination-page}" data-action="{pagination-action}">{pagination-next}</a></li>',r=c.previousButtonTemplate||'<li class="page-item griew-pagination-item"><a href="#" class="page-link griew-pagination-link" data-page="{pagination-page}" data-action="{pagination-action}">{pagination-previous}</a></li>',i=c.firstButtonTemplate||'<li class="page-item griew-pagination-item"><a href="#" class="page-link griew-pagination-link" data-page="{pagination-page}" data-action="{pagination-action}">{pagination-first}</a></li>',o=c.lastButtonTemplate||'<li class="page-item griew-pagination-item"><a href="#" class="page-link griew-pagination-link" data-page="{pagination-page}" data-action="{pagination-action}">{pagination-last}</a></li>',s=c.jumpNextButtonTemplate||'<li class="page-item griew-pagination-item"><a href="#" class="page-link griew-pagination-link" data-page="{pagination-page}" data-action="{pagination-action}">{pagination-jump-next}</a></li>',u=c.jumpPreviousButtonTemplate||'<li class="page-item griew-pagination-item"><a href="#" class="page-link griew-pagination-link" data-page="{pagination-page}" data-action="{pagination-action}">{pagination-jump-previous}</a></li>',l=c.manualNavigationTemplate||'<div class="input-group griew-pagination-manual"><input type="number" class="form-control griew-pagination-manual-input" value="{pagination-current}" min="1" max="{pagination-last}"><div class="input-group-append"><span class="input-group-text griew-pagination-manual-last">{pagination-last}</span></div></div>',d=c.perPageInputTemplate||'<div class="input-group griew-pagination-per-page"><input type="number" class="form-control griew-pagination-per-page-input" value="{pagination-per-page}" min="1"></div>'},p=function(e){var c=m.getPage(),p="",f="",g=0,h=Math.floor(2.5),v=5>c.currentPage+h?5:c.currentPage+h;v=v>c.lastPage?c.lastPage:v,e=e||{};var b=void 0==e.onePageNavigation||e.onePageNavigation,C=void 0==e.multiPagesNavigation||e.multiPagesNavigation,y=void 0==e.manualNavigation||e.manualNavigation,P=void 0==e.perPageInput||e.perPageInput,T=e.jumpPagesCount?e.jumpPagesCount:10;for(p=p.concat(w({"pagination-page":1,"pagination-action":"first","pagination-first":"<i></i>"},i)),C&&(p=p.concat(w({"pagination-page":T,"pagination-action":"previous","pagination-jump-previous":"<i></i>"},u))),b&&(p=p.concat(w({"pagination-page":1,"pagination-action":"previous","pagination-previous":"<i></i>"},r))),g=c.currentPage-h;;)if(g<=0)g++;else{if(g>v)break;p+=w({"pagination-page":g,"pagination-number":g,"pagination-action":"page"},n),g++}b&&(p=p.concat(w({"pagination-page":1,"pagination-action":"next","pagination-next":"<i></i>"},a))),C&&(p=p.concat(w({"pagination-page":T,"pagination-action":"next","pagination-jump-next":"<i></i>"},s))),p=p.concat(w({"pagination-page":c.lastPage,"pagination-action":"last","pagination-last":"<i></i>"},o)),y&&(f=f.concat(w({"pagination-current":c.currentPage,"pagination-last":c.lastPage},l))),P&&(f=f.concat(w({"pagination-per-page":c.perPage},d)));var x=$(w("pagination-items",p,t));return x.find('.griew-pagination-link[data-action="page"][data-page="'+c.currentPage+'"]').parent().addClass("active"),$('<div class="griew-pagination-wrapper">').append(x).append(f)},f=function(){var t=h.get("pagination");c(t),$(e).html(p(t)),$(e).off("click",".griew-pagination-link"),$(e).on("click",".griew-pagination-link",function(){var e=$(this).data("page");switch($(this).data("action")){case"page":m.gotoPage(e);break;case"next":m.gotoPage(m.getCurrentPage()+e);break;case"previous":m.gotoPage(m.getCurrentPage()-e);break;case"last":m.gotoLastPage();break;case"first":m.gotoFirstPage()}x()}),$(e).on("change",".griew-pagination-manual-input",function(){m.gotoPage($(this).val()),x()}),$(e).on("keypress",".griew-pagination-manual-input",function(e){13===e.keyCode&&$(this).change()}),$(e).on("change",".griew-pagination-per-page-input",function(){m.setPerPage($(this).val()),m.gotoFirstPage(),x()}),$(e).on("keypress",".griew-pagination-per-page-input",function(e){13===e.keyCode&&$(this).change()})};this.render=function(){var t=h.get("pagination");$(e).html(p(t))},this.generate=function(){f()}},o=new e,s=new t,u=new n,l=new a,d=new r,c=new i,v=[],b=[],w=function(e,t,n){var a=new RegExp("[{]{1}[ ]*[a-zA-Z0-9._-]+[ ]*[}]{1}","gi"),r=new RegExp("[{]{1}[ ]*("+e+"){1}[ ]*[}]{1}","gi");if("string"==typeof e)return n.replace(r,t);n=t,t=e;for(var i=n.match(a)||[],o=0;o<i.length;o++)e=i[o].replace(/[{ }]*/gi,""),n=w(e,t[e],n);return n},C=function(e){var t=0,n=s.visibles(),a=$(h.get("container")),r=a.find(o.container),i=a.find(u.container);r.html(""),i.html(u.render(n)),l.autoGenerate(n,function(e){return h.get("container")+" "+u.getCellSelector(e)}),d.autoGenerate(n,function(e){return h.get("container")+" "+u.getCellSelector(e)});var p=h.get("pagination")||{};for(void 0!=p.visibility&&1!=p.visibility||c.generate();t<e.length;t++)r.append(o.render(n,e[t],t+1,s.render))},y=function(e,t,n,a){for(var r=0;r<v.length;r++)v[r].name==e&&v[r].section==n||v[r].callback&&v[r].callback(v[r].name,v[r].container,n,a)},T=function(e,t,n,a){v.push({name:e,container:t,section:n,callback:a})};this.filters=function(){return l},this.orders=function(){return d},this.pagination=function(){return c},this.row=function(){return o},this.columns=function(){return s},this.render=function(e){e&&(b=Object.assign([],e)),C(b)}},o=function(){var e=[],t=[],n=[],a=[],r=function(t,n,a,r,i){var s={name:t,type:n,operator:a,operand1:r,operand2:i};o(t)?(s=o(t),s.name=t,s.type=n,s.operator=a,s.operand1=r,s.operand2=i,d(s)):(e.push(s),l(s))},i=function(t){for(var n in e)if(e[n].name===t){var a=e.splice(n,1);return c(a[0]),!0}return!1},o=function(t){for(var n in e)if(e[n].name===t)return e[n];return null},s=function(){for(;e.length;)i(e[0].name)},u=function(){return e},l=function(e){for(var n=0;n<t.length;n++)t[n](e)},d=function(e){for(var t=0;t<n.length;t++)n[t](e)},c=function(e){for(var t=0;t<a.length;t++)a[t](e)};this.add=r,this.remove=i,this.clear=s,this.find=o,this.toArray=u,Object.defineProperty(this,"onCreate",{set:function(e){t.push(e)}}),Object.defineProperty(this,"onUpdate",{set:function(e){n.push(e)}}),Object.defineProperty(this,"onRemove",{set:function(e){a.push(e)}})},s=function(){var e=[],t=[],n=[],a=[],r=function(t,n){var a={name:t,type:n.toUpperCase()};o(t)?(a=o(t),
a.name=t,a.type=n.toUpperCase(),d(a)):(e.push(a),l(a))},i=function(t){for(var n in e)if(e[n].name===t){var a=e.splice(n,1);return c(a[0]),!0}return!1},o=function(t){for(var n in e)if(e[n].name===t)return e[n];return null},s=function(e){var t=o(e);if(null===t)return!1;"ASC"===t.type?t.type="DESC":t.type="ASC",d(t)},u=function(){for(;e.length;)i(e[0].name)},l=function(e){for(var n=0;n<t.length;n++)t[n](e)},d=function(e){for(var t=0;t<n.length;t++)n[t](e)},c=function(e){for(var t=0;t<a.length;t++)a[t](e)},p=function(){return e};this.addAscending=function(e){return!!e&&(r(e,"ASC"),!0)},this.addDescending=function(e){return!!e&&(r(e,"DESC"),!0)},this.remove=i,this.clear=u,this.find=o,this.swap=s,this.toArray=p,Object.defineProperty(this,"onCreate",{set:function(e){t.push(e)}}),Object.defineProperty(this,"onUpdate",{set:function(e){n.push(e)}}),Object.defineProperty(this,"onRemove",{set:function(e){a.push(e)}})},u=function(){var e={currentPage:1,lastPage:1,perPage:15,total:0,from:1,count:0},t=function(t){t&&parseInt(t)>0&&(t=parseInt(t),e.currentPage=t,t>e.lastPage&&(e.currentPage=e.lastPage))},n=function(){e.currentPage<e.lastPage&&e.currentPage++},a=function(){e.currentPage>1&&e.currentPage--},r=function(){e.currentPage=1},i=function(){e.currentPage=e.lastPage},o=function(t){t&&parseInt(t)>0&&(e.perPage=t)},s=function(){return e.perPage},u=function(){return e.currentPage},l=function(n,a,r,i,o,s){t(n),a=parseInt(a),r=parseInt(r),i=parseInt(i),o=parseInt(o),s=parseInt(s),e.lastPage=a&&a>0?a:e.lastPage,e.perPage=r&&r>0?r:e.perPage,e.total=i&&i>=0?i:e.total,e.from=o&&o>0?o:e.from,e.count=s&&s>=0?s:e.count},d=function(){return e};this.gotoPage=t,this.gotoNextPage=n,this.gotoPreviousPage=a,this.gotoFirstPage=r,this.gotoLastPage=i,this.setPerPage=o,this.getPerPage=s,this.getCurrentPage=u,this.setPage=l,this.getPage=d},l=function(){var e={},t=function(t,n){e[t]=n},n=function(t){return e[t]},a=function(t){return void 0!==e[t]};this.set=t,this.get=n,this.exists=a},d=new t,c=new r,p=new i,f=new o,g=new s,m=new u,h=new l,v=new a,b=[],w=[];Object.defineProperty(this,"onRefresh",{set:function(e){b.push(e)}}),Object.defineProperty(this,"onLoad",{set:function(e){w.push(e)}});var C=function(){for(var e=0;e<b.length;e++)b[e]()},y=function(){for(var e=0;e<w.length;e++)w[e]()};c.setDefault("ajax"),h.set("container",e||".griew");var P=function(e,t){return d.trans(e,t)},T=function(){p.render()},x=function(){C(),c.run((new n).collect(),function(e){v=e;var t=e.getPagination();m.setPage(t.currentPage,t.lastPage,t.perPage,t.total,t.from,t.count),p.render(e.getData());for(var n=e.getFilters(),a=0;a<n.length;a++)f.add(n[a].name,n[a].type,n[a].operator,n[a].operand1,n[a].operand2);for(var r=e.getOrders(),a=0;a<r.length;a++)"DESC"===r[a].type?g.addDescending(r[a].name):g.addAscending(r[a].name);y()})};this.view=function(){return p},this.filter=function(){return f},this.order=function(){return g},this.pagination=function(){return m},this.options=function(){return h},this.response=function(){return v},this.dataProvider=function(){return c},this.setLang=d.setLang,this.setLocale=d.setLocale,this.getLocale=d.getLocale,this.isLocale=d.isLocale,this.trans=d.trans,this.refresh=x,this.render=T};